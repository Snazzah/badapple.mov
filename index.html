<!DOCTYPE html>
<html>
  <head>
    <title>Bad Apple!!</title>
    <link rel="canonical" href="https://badapple.mov/" />
    <link rel="icon" type="image/png" sizes="480x480" href="/badicon.png">
    <meta property="og:url" content="https://badapple.mov/">
    <meta property="og:video" content="https://badapple.mov/badapple.mp4" />
    <meta property="og:video:secure_url" content="https://badapple.mov/badapple.mp4">
    <meta property="og:video:width" content="480" />
    <meta property="og:video:height" content="360" />
    <meta property="og:video:type" content="video/mp4" />
    <meta property="og:type" content="video.other">
    <meta property="og:image" content="https://badapple.mov/badapple.jpg">
    <meta name="twitter:site" content="@snazzah">
    <meta name="twitter:domain" content="badapple.mov">
    <meta name="twitter:card" content="player" />
    <meta name="twitter:image" content="https://badapple.mov/badapple.jpg">
    <meta name="twitter:player" content="https://badapple.mov/badapple.mp4" />
    <meta name="twitter:player:width" content="480" />
    <meta name="twitter:player:height" content="360" />
    <meta name="twitter:player:stream" content="https://badapple.mov/badapple.mp4" />
    <meta name="twitter:player:stream:content_type" content="video/mp4" />
    <meta property="title" content="badapple">
    <style type="text/css">
      *, body, html, video, source {
        margin: 0;
        padding: 0;
        overflow: hidden;
      }
      video {
        height: 100vh;
        width: 100%;
        object-fit: cover;
      }
      button {
        height: 100vh;
        width: 100%;
        opacity: 0;
        position: fixed;
      }
    </style>
  </head>
  <body>
    <button></button>
    <video src="/badapple.mov" autoplay loop controls muted></video>
    <script>
      const video = document.querySelector("video"),
        unmuteButton = document.querySelector("button"),
        favicon = document.querySelector("link[rel='icon']"),
        canvas = document.createElement("canvas"),
        ctx = canvas.getContext('2d');
      function screenshotToFavicon() {
        const size = video.videoHeight,
          widthCrop = (video.videoWidth - video.videoHeight) / 2;
        canvas.width = 64;
        canvas.height = 64;
        ctx.drawImage(video, widthCrop, 0, size, size, 0, 0, canvas.width, canvas.height);
        favicon.href = canvas.toDataURL();
      }
      setInterval(() => { if (!video.paused) screenshotToFavicon(); }, 100);
      video.onclick = () => (video.muted = false);
      unmuteButton.addEventListener("click", () => {video.muted = false;unmuteButton.remove()}, { once: true });
    </script>
  </body>
</html>
